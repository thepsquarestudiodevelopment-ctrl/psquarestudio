<!DOCTYPE html>
<html class="no-js" lang="zxx">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <title>PSquare Studio</title>
    <meta name="description" content="PSquare Studio" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link rel="stylesheet" href="assets/css/portfolio.css" />

    <link
      rel="shortcut icon"
      type="image/x-icon"
      href="assets/img/logo/Asset1.png"
    />
    <link rel="stylesheet" href="assets/css/bootstrap.min.css" />
    <link rel="stylesheet" href="assets/css/magnific-popup.css" />
    <link rel="stylesheet" href="assets/css/fontawesome-all.min.css" />
    <link rel="stylesheet" href="assets/css/swiper-bundle.min.css" />
    <link rel="stylesheet" href="assets/css/odometer.css" />
    <link rel="stylesheet" href="assets/css/ion.rangeSlider.min.css" />
    <link rel="stylesheet" href="assets/css/effect-slicer.css" />
    <link rel="stylesheet" href="assets/css/animate.css" />
    <link rel="stylesheet" href="assets/css/defauls-spacing.css" />
    <link rel="stylesheet" href="assets/css/main.css" />
  </head>
  <body>
    <div id="smooth-wrapper">
      <div id="smooth-content">
        <main>
          <!-- PORTFOLIO GRID UPDATED -->
          <div
            class="td-portfolio-filter-area td-portfolio-filter-three pb-160"
          >
            <div class="container-fluid container-1830">
              <!-- Filter Buttons -->
              <div class="row">
                <div class="col-lg-12 mb-50">
                  <div
                    class="portfolio-filter-scroll"
                    id="portfolioFilterScroll"
                    role="toolbar"
                    aria-label="Portfolio filters"
                  >
                    <div
                      class="td-portfolio-filter-btn masonary-menu"
                      role="group"
                      aria-label="Filter buttons"
                    >
                      <button
                        data-filter="*"
                        class="active"
                        aria-pressed="true"
                      >
                        SHOW ALL
                      </button>
                      <button data-filter=".prof">Graphic Design</button>
                      <button data-filter=".prof1">Motion Ads</button>
                      <button data-filter=".prof2">Video Editing</button>
                      <button data-filter=".prof3">3D Architecture</button>
                      <button data-filter=".prof4">CGI</button>
                    </div>
                  </div>
                </div>
              </div>

              <!-- GRID -->
              <div class="grid row" id="portfolioGrid">
                <!-- 3d architecture images start -->
                <!-- Item 1 -->
                <div class="col-lg-4 col-md-6 grid-item prof prof1 mb-30">
                  <div
                    class="td-portfolio-filter-wrapper"
                    tabindex="0"
                    role="button"
                    aria-label="Open Project Title 1"
                  >
                    <div class="td-portfolio-filter-thumb">
                      <img
                        data-src="assets/img/portfolio/3D Architecture/1.jpg"
                        alt="Project 1"
                        class="lazy"
                      />
                    </div>
                  </div>
                </div>
                <!-- Item 2 -->
                <div class="col-lg-4 col-md-6 grid-item prof prof1 mb-30">
                  <div
                    class="td-portfolio-filter-wrapper"
                    tabindex="0"
                    role="button"
                    aria-label="Open Project Title 1"
                  >
                    <div class="td-portfolio-filter-thumb">
                      <img
                        data-src="assets/img/portfolio/3D Architecture/2.jpg"
                        alt="Project 1"
                        class="lazy"
                      />
                    </div>
                  </div>
                </div>
                <!-- Item 3 -->
                <div class="col-lg-4 col-md-6 grid-item prof prof1 mb-30">
                  <div
                    class="td-portfolio-filter-wrapper"
                    tabindex="0"
                    role="button"
                    aria-label="Open Project Title 1"
                  >
                    <div class="td-portfolio-filter-thumb">
                      <img
                        data-src="assets/img/portfolio/3D Architecture/3.jpg"
                        alt="Project 1"
                        class="lazy"
                      />
                    </div>
                  </div>
                </div>
                <!-- Item 4 -->
                <div class="col-lg-4 col-md-6 grid-item prof prof1 mb-30">
                  <div
                    class="td-portfolio-filter-wrapper"
                    tabindex="0"
                    role="button"
                    aria-label="Open Project Title 1"
                  >
                    <div class="td-portfolio-filter-thumb">
                      <img
                        data-src="assets/img/portfolio/3D Architecture/4.jpg"
                        alt="Project 1"
                        class="lazy"
                      />
                    </div>
                  </div>
                </div>
                <!-- Item 5 -->
                <div class="col-lg-4 col-md-6 grid-item prof prof1 mb-30">
                  <div
                    class="td-portfolio-filter-wrapper"
                    tabindex="0"
                    role="button"
                    aria-label="Open Project Title 1"
                  >
                    <div class="td-portfolio-filter-thumb">
                      <img
                        data-src="assets/img/portfolio/3D Architecture/5.jpg"
                        alt="Project 1"
                        class="lazy"
                      />
                    </div>
                  </div>
                </div>
                <!-- 3d architecture images end -->
                <!-- cgi videos start -->
                <!-- Item 1 -->
                <div class="col-lg-4 col-md-6 grid-item prof2 mb-30">
                  <div
                    class="td-portfolio-filter-wrapper"
                    tabindex="0"
                    role="button"
                    aria-label="Open Motion Ad 2"
                  >
                    <div class="td-portfolio-filter-thumb">
                      <video
                        class="lazy-video"
                        autoplay="true"
                        muted
                        loop
                        playsinline
                        preload="metadata"
                        data-src="assets/img/portfolio/CGI/1.mp4"
                        data-thumb="assets/img/portfolio/CGI/thumbnail_1.jpg"
                      ></video>
                    </div>
                  </div>
                </div>
                <!-- Item 2 -->
                <div class="col-lg-4 col-md-6 grid-item prof2 mb-30">
                  <div
                    class="td-portfolio-filter-wrapper"
                    tabindex="0"
                    role="button"
                    aria-label="Open Motion Ad 2"
                  >
                    <div class="td-portfolio-filter-thumb">
                      <video
                        class="lazy-video"
                        autoplay="true"
                        muted
                        loop
                        playsinline
                        preload="metadata"
                        data-src="assets/img/portfolio/CGI/2.mp4"
                        data-thumb="assets/img/portfolio/CGI/thumbnail_2.jpg"
                      ></video>
                    </div>
                  </div>
                </div>
                <!-- Item 3 -->
                <div class="col-lg-4 col-md-6 grid-item prof2 mb-30">
                  <div
                    class="td-portfolio-filter-wrapper"
                    tabindex="0"
                    role="button"
                    aria-label="Open Motion Ad 2"
                  >
                    <div class="td-portfolio-filter-thumb">
                      <video
                        class="lazy-video"
                        autoplay="true"
                        muted
                        loop
                        playsinline
                        preload="metadata"
                        data-src="assets/img/portfolio/CGI/3.mp4"
                        data-thumb="assets/img/portfolio/CGI/thumbnail_3.jpg"
                      ></video>
                    </div>
                  </div>
                </div>
                <!-- Item 4 -->
                <div class="col-lg-4 col-md-6 grid-item prof2 mb-30">
                  <div
                    class="td-portfolio-filter-wrapper"
                    tabindex="0"
                    role="button"
                    aria-label="Open Motion Ad 2"
                  >
                    <div class="td-portfolio-filter-thumb">
                      <video
                        class="lazy-video"
                        autoplay="true"
                        muted
                        loop
                        playsinline
                        preload="metadata"
                        data-src="assets/img/portfolio/CGI/4.mp4"
                        data-thumb="assets/img/portfolio/CGI/thumbnail_4.jpg"
                      ></video>
                    </div>
                  </div>
                </div>
                <!-- cgi videos end -->
                <!-- set design images start -->
                <!-- Item 1 -->
                <div class="col-lg-4 col-md-6 grid-item prof prof1 mb-30">
                  <div
                    class="td-portfolio-filter-wrapper"
                    tabindex="0"
                    role="button"
                    aria-label="Open Project Title 1"
                  >
                    <div class="td-portfolio-filter-thumb">
                      <img
                        data-src="assets/img/portfolio/Set design/1.jpg"
                        alt="Project 1"
                        class="lazy"
                      />
                    </div>
                  </div>
                </div>
                <!-- Item 2 -->
                <div class="col-lg-4 col-md-6 grid-item prof prof1 mb-30">
                  <div
                    class="td-portfolio-filter-wrapper"
                    tabindex="0"
                    role="button"
                    aria-label="Open Project Title 1"
                  >
                    <div class="td-portfolio-filter-thumb">
                      <img
                        data-src="assets/img/portfolio/Set design/2.jpg"
                        alt="Project 1"
                        class="lazy"
                      />
                    </div>
                  </div>
                </div>
                <!-- Item 3 -->
                <div class="col-lg-4 col-md-6 grid-item prof prof1 mb-30">
                  <div
                    class="td-portfolio-filter-wrapper"
                    tabindex="0"
                    role="button"
                    aria-label="Open Project Title 1"
                  >
                    <div class="td-portfolio-filter-thumb">
                      <img
                        data-src="assets/img/portfolio/Set design/3.jpg"
                        alt="Project 1"
                        class="lazy"
                      />
                    </div>
                  </div>
                </div>
                <!-- Item 4 -->
                <div class="col-lg-4 col-md-6 grid-item prof prof1 mb-30">
                  <div
                    class="td-portfolio-filter-wrapper"
                    tabindex="0"
                    role="button"
                    aria-label="Open Project Title 1"
                  >
                    <div class="td-portfolio-filter-thumb">
                      <img
                        data-src="assets/img/portfolio/Set design/4.jpg"
                        alt="Project 1"
                        class="lazy"
                      />
                    </div>
                  </div>
                </div>
                <!-- Item 5 -->
                <div class="col-lg-4 col-md-6 grid-item prof prof1 mb-30">
                  <div
                    class="td-portfolio-filter-wrapper"
                    tabindex="0"
                    role="button"
                    aria-label="Open Project Title 1"
                  >
                    <div class="td-portfolio-filter-thumb">
                      <img
                        data-src="assets/img/portfolio/Set design/5.jpg"
                        alt="Project 1"
                        class="lazy"
                      />
                    </div>
                  </div>
                </div>
                <!-- Item 6 -->
                <div class="col-lg-4 col-md-6 grid-item prof prof1 mb-30">
                  <div
                    class="td-portfolio-filter-wrapper"
                    tabindex="0"
                    role="button"
                    aria-label="Open Project Title 1"
                  >
                    <div class="td-portfolio-filter-thumb">
                      <img
                        data-src="assets/img/portfolio/Set design/6.jpg"
                        alt="Project 1"
                        class="lazy"
                      />
                    </div>
                  </div>
                </div>
                <!-- Item 7 -->
                <div class="col-lg-4 col-md-6 grid-item prof prof1 mb-30">
                  <div
                    class="td-portfolio-filter-wrapper"
                    tabindex="0"
                    role="button"
                    aria-label="Open Project Title 1"
                  >
                    <div class="td-portfolio-filter-thumb">
                      <img
                        data-src="assets/img/portfolio/Set design/7.jpg"
                        alt="Project 1"
                        class="lazy"
                      />
                    </div>
                  </div>
                </div>
                <!-- Item 8 -->
                <div class="col-lg-4 col-md-6 grid-item prof prof1 mb-30">
                  <div
                    class="td-portfolio-filter-wrapper"
                    tabindex="0"
                    role="button"
                    aria-label="Open Project Title 1"
                  >
                    <div class="td-portfolio-filter-thumb">
                      <img
                        data-src="assets/img/portfolio/Set design/8.jpg"
                        alt="Project 1"
                        class="lazy"
                      />
                    </div>
                  </div>
                </div>
                <!-- Item 9 -->
                <div class="col-lg-4 col-md-6 grid-item prof prof1 mb-30">
                  <div
                    class="td-portfolio-filter-wrapper"
                    tabindex="0"
                    role="button"
                    aria-label="Open Project Title 1"
                  >
                    <div class="td-portfolio-filter-thumb">
                      <img
                        data-src="assets/img/portfolio/Set design/9.jpg"
                        alt="Project 1"
                        class="lazy"
                      />
                    </div>
                  </div>
                </div>
                <!-- Item 10 -->
                <div class="col-lg-4 col-md-6 grid-item prof prof1 mb-30">
                  <div
                    class="td-portfolio-filter-wrapper"
                    tabindex="0"
                    role="button"
                    aria-label="Open Project Title 1"
                  >
                    <div class="td-portfolio-filter-thumb">
                      <img
                        data-src="assets/img/portfolio/Set design/10.jpg"
                        alt="Project 1"
                        class="lazy"
                      />
                    </div>
                  </div>
                </div>
                <!-- Item 11 -->
                <div class="col-lg-4 col-md-6 grid-item prof prof1 mb-30">
                  <div
                    class="td-portfolio-filter-wrapper"
                    tabindex="0"
                    role="button"
                    aria-label="Open Project Title 1"
                  >
                    <div class="td-portfolio-filter-thumb">
                      <img
                        data-src="assets/img/portfolio/Set design/11.jpg"
                        alt="Project 1"
                        class="lazy"
                      />
                    </div>
                  </div>
                </div>
                <!-- Item 12 -->
                <div class="col-lg-4 col-md-6 grid-item prof prof1 mb-30">
                  <div
                    class="td-portfolio-filter-wrapper"
                    tabindex="0"
                    role="button"
                    aria-label="Open Project Title 1"
                  >
                    <div class="td-portfolio-filter-thumb">
                      <img
                        data-src="assets/img/portfolio/Set design/12.jpg"
                        alt="Project 1"
                        class="lazy"
                      />
                    </div>
                  </div>
                </div>
                <!-- Item 13 -->
                <div class="col-lg-4 col-md-6 grid-item prof prof1 mb-30">
                  <div
                    class="td-portfolio-filter-wrapper"
                    tabindex="0"
                    role="button"
                    aria-label="Open Project Title 1"
                  >
                    <div class="td-portfolio-filter-thumb">
                      <img
                        data-src="assets/img/portfolio/Set design/13.jpg"
                        alt="Project 1"
                        class="lazy"
                      />
                    </div>
                  </div>
                </div>
                <!-- Item 14 -->
                <div class="col-lg-4 col-md-6 grid-item prof prof1 mb-30">
                  <div
                    class="td-portfolio-filter-wrapper"
                    tabindex="0"
                    role="button"
                    aria-label="Open Project Title 1"
                  >
                    <div class="td-portfolio-filter-thumb">
                      <img
                        data-src="assets/img/portfolio/Set design/14.jpg"
                        alt="Project 1"
                        class="lazy"
                      />
                    </div>
                  </div>
                </div>
                <!-- Item 15 -->
                <div class="col-lg-4 col-md-6 grid-item prof prof1 mb-30">
                  <div
                    class="td-portfolio-filter-wrapper"
                    tabindex="0"
                    role="button"
                    aria-label="Open Project Title 1"
                  >
                    <div class="td-portfolio-filter-thumb">
                      <img
                        data-src="assets/img/portfolio/Set design/15.jpg"
                        alt="Project 1"
                        class="lazy"
                      />
                    </div>
                  </div>
                </div>
                <!-- Item 16 -->
                <div class="col-lg-4 col-md-6 grid-item prof prof1 mb-30">
                  <div
                    class="td-portfolio-filter-wrapper"
                    tabindex="0"
                    role="button"
                    aria-label="Open Project Title 1"
                  >
                    <div class="td-portfolio-filter-thumb">
                      <img
                        data-src="assets/img/portfolio/Set design/16.jpg"
                        alt="Project 1"
                        class="lazy"
                      />
                    </div>
                  </div>
                </div>
                <!-- Item 17 -->
                <div class="col-lg-4 col-md-6 grid-item prof prof1 mb-30">
                  <div
                    class="td-portfolio-filter-wrapper"
                    tabindex="0"
                    role="button"
                    aria-label="Open Project Title 1"
                  >
                    <div class="td-portfolio-filter-thumb">
                      <img
                        data-src="assets/img/portfolio/Set design/17.jpg"
                        alt="Project 1"
                        class="lazy"
                      />
                    </div>
                  </div>
                </div>
                <!-- Item 18 -->
                <div class="col-lg-4 col-md-6 grid-item prof prof1 mb-30">
                  <div
                    class="td-portfolio-filter-wrapper"
                    tabindex="0"
                    role="button"
                    aria-label="Open Project Title 1"
                  >
                    <div class="td-portfolio-filter-thumb">
                      <img
                        data-src="assets/img/portfolio/Set design/18.jpg"
                        alt="Project 1"
                        class="lazy"
                      />
                    </div>
                  </div>
                </div>
                <!-- set design images end -->
                <!-- motion graphics videos start -->
                <!-- Item 1 -->
                <div class="col-lg-4 col-md-6 grid-item prof2 mb-30">
                  <div
                    class="td-portfolio-filter-wrapper"
                    tabindex="0"
                    role="button"
                    aria-label="Open Motion Ad 2"
                  >
                    <div class="td-portfolio-filter-thumb">
                      <video
                        class="lazy-video"
                        autoplay="true"
                        muted
                        loop
                        playsinline
                        preload="metadata"
                        data-src="assets/img/portfolio/Motion graphics/1.mp4"
                        data-thumb="assets/img/portfolio/Motion graphics/thumbnail_1.jpg"
                      ></video>
                    </div>
                  </div>
                </div>
                <!-- Item 2 -->
                <div class="col-lg-4 col-md-6 grid-item prof2 mb-30">
                  <div
                    class="td-portfolio-filter-wrapper"
                    tabindex="0"
                    role="button"
                    aria-label="Open Motion Ad 2"
                  >
                    <div class="td-portfolio-filter-thumb">
                      <video
                        class="lazy-video"
                        autoplay="true"
                        muted
                        loop
                        playsinline
                        preload="metadata"
                        data-src="assets/img/portfolio/Motion graphics/2.mp4"
                        data-thumb="assets/img/portfolio/Motion graphics/thumbnail_2.jpg"
                      ></video>
                    </div>
                  </div>
                </div>
                <!-- Item 3 -->
                <div class="col-lg-4 col-md-6 grid-item prof2 mb-30">
                  <div
                    class="td-portfolio-filter-wrapper"
                    tabindex="0"
                    role="button"
                    aria-label="Open Motion Ad 2"
                  >
                    <div class="td-portfolio-filter-thumb">
                      <video
                        class="lazy-video"
                        autoplay="true"
                        muted
                        playsinline
                        preload="metadata"
                        data-src="assets/img/portfolio/Motion graphics/3.mp4"
                        data-thumb="assets/img/portfolio/Motion graphics/thumbnail_3.jpg"
                      ></video>
                    </div>
                  </div>
                </div>
                <!-- Item 4 -->
                <div class="col-lg-4 col-md-6 grid-item prof2 mb-30">
                  <div
                    class="td-portfolio-filter-wrapper"
                    tabindex="0"
                    role="button"
                    aria-label="Open Motion Ad 2"
                  >
                    <div class="td-portfolio-filter-thumb">
                      <video
                        class="lazy-video"
                        autoplay="true"
                        muted
                        loop
                        playsinline
                        preload="metadata"
                        data-src="assets/img/portfolio/Motion graphics/4.mp4"
                        data-thumb="assets/img/portfolio/Motion graphics/thumbnail_4.jpg"
                      ></video>
                    </div>
                  </div>
                </div>
                <!-- Item 5 -->
                <div class="col-lg-4 col-md-6 grid-item prof2 mb-30">
                  <div
                    class="td-portfolio-filter-wrapper"
                    tabindex="0"
                    role="button"
                    aria-label="Open Motion Ad 2"
                  >
                    <div class="td-portfolio-filter-thumb">
                      <video
                        class="lazy-video"
                        autoplay="true"
                        muted
                        loop
                        playsinline
                        preload="metadata"
                        data-src="assets/img/portfolio/Motion graphics/5.mp4"
                        data-thumb="assets/img/portfolio/Motion graphics/thumbnail_5.jpg"
                      ></video>
                    </div>
                  </div>
                </div>
                <!-- motion graphic videos end -->
                <!-- Add more items as needed -->
              </div>
            </div>
          </div>
        </main>

        <!-- LIGHTBOX OVERLAY: MAIN + THUMBNAILS -->
        <div id="lightboxOverlay" aria-hidden="true">
          <button id="lightboxClose" aria-label="Close lightbox">×</button>
          <button id="lbPrev" class="lb-nav" aria-label="Previous">❮</button>
          <button id="lbNext" class="lb-nav" aria-label="Next">❯</button>

          <!-- lightboxContent now contains .lb-main (main preview) and .lb-thumbs (film-strip) -->
          <div id="lightboxContent" role="dialog" aria-modal="true">
            <div
              class="lb-main"
              id="lbMainArea"
              tabindex="0"
              aria-live="polite"
            >
              <!-- main preview is injected by JS (image or video element) -->
            </div>

            <!-- thumbnails film-strip -->
            <div
              class="lb-thumbs"
              id="lbThumbs"
              role="toolbar"
              aria-label="Gallery thumbnails"
            >
              <!-- thumbnails injected by JS -->
            </div>

            <div id="lbLoader" class="lb-loader" style="display: none"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- JS files (Make sure these paths exist in your project) -->
    <script src="assets/js/vendor/jquery.js"></script>
    <script src="assets/js/bootstrap.min.js"></script>
    <script src="assets/js/jsap/gsap.js"></script>
    <script src="assets/js/jsap/gsap-scroll-smoother.js"></script>
    <script src="assets/js/jsap/gsap-scroll-trigger.js"></script>
    <script src="assets/js/jsap/gsap-scroll-to-plugin.js"></script>
    <script src="assets/js/jsap/gsap-split-text.js"></script>
    <script src="assets/js/isotope.pkgd.min.js"></script>
    <script src="assets/js/imagesloaded.pkgd.min.js"></script>
    <script src="assets/js/main.js"></script>
    <!-- ===========================
         DRAG SCROLL + ISOTOPE + LAZY + LIGHTBOX (with thumbnails)
         =========================== -->
    <script>
      (function () {
        // set year
        const yElem = document.getElementById("yearNow");
        if (yElem) yElem.textContent = new Date().getFullYear();

        /* -----------------------
           MOBILE FILTER SCROLL (drag-to-scroll)
           ----------------------- */
        const scrollContainer = document.getElementById(
          "portfolioFilterScroll"
        );
        if (scrollContainer) {
          let isDown = false;
          let startX;
          let scrollLeft;

          // Mouse events
          scrollContainer.addEventListener("mousedown", (e) => {
            isDown = true;
            scrollContainer.classList.add("active");
            startX = e.pageX - scrollContainer.offsetLeft;
            scrollLeft = scrollContainer.scrollLeft;
            e.preventDefault();
          });
          scrollContainer.addEventListener("mouseleave", () => {
            isDown = false;
            scrollContainer.classList.remove("active");
          });
          scrollContainer.addEventListener("mouseup", () => {
            isDown = false;
            scrollContainer.classList.remove("active");
          });
          scrollContainer.addEventListener("mousemove", (e) => {
            if (!isDown) return;
            e.preventDefault();
            const x = e.pageX - scrollContainer.offsetLeft;
            const walk = (x - startX) * 1.5;
            scrollContainer.scrollLeft = scrollLeft - walk;
          });

          // Touch events
          let touchStartX = 0;
          let touchScrollLeft = 0;
          scrollContainer.addEventListener(
            "touchstart",
            (e) => {
              touchStartX = e.touches[0].pageX - scrollContainer.offsetLeft;
              touchScrollLeft = scrollContainer.scrollLeft;
            },
            { passive: true }
          );
          scrollContainer.addEventListener(
            "touchmove",
            (e) => {
              const x = e.touches[0].pageX - scrollContainer.offsetLeft;
              const walk = (x - touchStartX) * 1.2;
              scrollContainer.scrollLeft = touchScrollLeft - walk;
            },
            { passive: true }
          );
        }

        /* -----------------------
           ISOTOPE INIT
           ----------------------- */
        function initIsotope() {
          const grid = document.querySelector("#portfolioGrid");
          const filterButtons = document.querySelectorAll(
            ".td-portfolio-filter-btn button"
          );
          if (!grid) return;

          imagesLoaded(grid, function () {
            const iso = new Isotope(grid, {
              itemSelector: ".grid-item",
              layoutMode: "masonry",
              percentPosition: true,
              masonry: { columnWidth: ".grid-item" },
            });

            filterButtons.forEach((btn) => {
              btn.addEventListener("click", function () {
                const filterValue = btn.getAttribute("data-filter") || "*";
                iso.arrange({ filter: filterValue });

                filterButtons.forEach((b) => {
                  b.classList.remove("active");
                  b.setAttribute("aria-pressed", "false");
                });
                btn.classList.add("active");
                btn.setAttribute("aria-pressed", "true");

                // center clicked filter button on mobile
                if (scrollContainer && window.innerWidth < 768) {
                  const btnRect = btn.getBoundingClientRect();
                  const containerRect = scrollContainer.getBoundingClientRect();
                  const offset =
                    btnRect.left -
                    containerRect.left -
                    containerRect.width / 2 +
                    btnRect.width / 2;
                  scrollContainer.scrollBy({
                    left: offset,
                    behavior: "smooth",
                  });
                }
              });
            });

            window.addEventListener("resize", function () {
              iso.layout();
            });
          });
        }
        if (document.readyState === "loading") {
          document.addEventListener("DOMContentLoaded", initIsotope);
        } else {
          initIsotope();
        }

        /* -----------------------
           MOBILE MENU
           ----------------------- */
        const mobileToggle = document.getElementById("mobileToggle");
        const mobileMenu = document.getElementById("mobileMenu");
        const closeMenu = document.getElementById("closeMenu");
        const overlay = document.getElementById("overlay");
        function openMobileMenu() {
          if (mobileMenu) {
            mobileMenu.style.display = "block";
            mobileMenu.setAttribute("aria-hidden", "false");
          }
          if (overlay) overlay.style.display = "block";
          if (mobileToggle) mobileToggle.setAttribute("aria-expanded", "true");
        }
        function closeMobile() {
          if (mobileMenu) {
            mobileMenu.style.display = "none";
            mobileMenu.setAttribute("aria-hidden", "true");
          }
          if (overlay) overlay.style.display = "none";
          if (mobileToggle) mobileToggle.setAttribute("aria-expanded", "false");
        }
        if (mobileToggle)
          mobileToggle.addEventListener("click", openMobileMenu);
        if (closeMenu) closeMenu.addEventListener("click", closeMobile);
        if (overlay) overlay.addEventListener("click", closeMobile);

        // Preloader hide
        window.addEventListener("load", function () {
          const pre = document.getElementById("preloader");
          if (pre) pre.style.display = "none";
        });

        /* ======================
           LAZY LOADING
           ====================== */
        const lazyImages = [].slice.call(document.querySelectorAll("img.lazy"));
        const lazyVideos = [].slice.call(
          document.querySelectorAll("video.lazy-video")
        );

        if ("IntersectionObserver" in window) {
          const lazyImageObserver = new IntersectionObserver(
            function (entries, observer) {
              entries.forEach(function (entry) {
                if (entry.isIntersecting) {
                  const img = entry.target;
                  const src = img.dataset.src;
                  if (src) {
                    img.src = src;
                    img.removeAttribute("data-src");
                  }
                  img.classList.remove("lazy");
                  lazyImageObserver.unobserve(img);
                }
              });
            },
            { rootMargin: "200px 0px" }
          );

          lazyImages.forEach(function (img) {
            lazyImageObserver.observe(img);
          });

          const lazyVideoObserver = new IntersectionObserver(
            function (entries, observer) {
              entries.forEach(function (entry) {
                if (entry.isIntersecting) {
                  const video = entry.target;
                  const src = video.dataset.src;
                  if (src) {
                    const source = document.createElement("source");
                    source.src = src;
                    source.type = "video/mp4";
                    video.appendChild(source);
                  }
                  video.load();
                  video.classList.remove("lazy-video");
                  lazyVideoObserver.unobserve(video);
                }
              });
            },
            { rootMargin: "400px 0px" }
          );

          lazyVideos.forEach(function (video) {
            lazyVideoObserver.observe(video);
          });
        } else {
          // Fallback: load all immediately
          lazyImages.forEach(function (img) {
            img.src = img.dataset.src;
            img.classList.remove("lazy");
          });
          lazyVideos.forEach(function (video) {
            const source = document.createElement("source");
            source.src = video.dataset.src;
            source.type = "video/mp4";
            video.appendChild(source);
            video.load();
            video.classList.remove("lazy-video");
          });
        }

        /* ======================
           LIGHTBOX + THUMBNAILS
           ====================== */
        const wrappers = Array.from(
          document.querySelectorAll(".td-portfolio-filter-wrapper")
        );
        const overlayLB = document.getElementById("lightboxOverlay");
        const lbMainArea = document.getElementById("lbMainArea");
        const lbThumbs = document.getElementById("lbThumbs");
        const closeBtn = document.getElementById("lightboxClose");
        const prevBtn = document.getElementById("lbPrev");
        const nextBtn = document.getElementById("lbNext");
        const loader = document.getElementById("lbLoader");

        // Build gallery array using DOM order; capture type and src for both image and video
        const gallery = wrappers
          .map((wrap) => {
            const img = wrap.querySelector("img");
            const video = wrap.querySelector("video");
            if (img) {
              return {
                type: "image",
                src: img.dataset ? img.dataset.src || img.src : img.src,
                thumb: img.dataset ? img.dataset.src || img.src : img.src,
                alt: img.alt || "",
              };
            }
            if (video) {
              // try dataset or nested source
              const vsrc = video.dataset
                ? video.dataset.src
                : video.querySelector("source")
                ? video.querySelector("source").src
                : "";
              // find a thumbnail poster if provided else use a static frame (first frame) or a placeholder
              // If you have poster images for videos, set data-thumb on the video tag in HTML (recommended).
              const thumb =
                video.dataset && video.dataset.thumb
                  ? video.dataset.thumb
                  : video.dataset && video.dataset.poster
                  ? video.dataset.poster
                  : "assets/img/video-thumb-placeholder.jpg";
              return { type: "video", src: vsrc, thumb: thumb, alt: "" };
            }
            return null;
          })
          .filter(Boolean);

        // build thumbnails DOM once
        function buildThumbs() {
          lbThumbs.innerHTML = "";
          gallery.forEach((item, i) => {
            const t = document.createElement("button");
            t.className = "lb-thumb";
            t.setAttribute("data-index", i);
            t.setAttribute("aria-label", "Open item " + (i + 1));
            t.setAttribute("type", "button");
            // set tabindex for keyboard navigation
            t.tabIndex = 0;

            if (item.type === "image") {
              const im = document.createElement("img");
              im.src = item.thumb || item.src;
              im.alt = item.alt || "thumb " + (i + 1);
              t.appendChild(im);
            } else {
              const im = document.createElement("img");
              im.src = item.thumb || "assets/img/video-thumb-placeholder.jpg";
              im.alt = "video thumb " + (i + 1);
              t.appendChild(im);
            }

            // click handling
            t.addEventListener("click", (e) => {
              const idx = parseInt(t.getAttribute("data-index"), 10);
              showLightbox(idx, true);
            });

            // keyboard support (Enter / Space)
            t.addEventListener("keydown", (e) => {
              if (e.key === "Enter" || e.key === " ") {
                e.preventDefault();
                const idx = parseInt(t.getAttribute("data-index"), 10);
                showLightbox(idx, true);
              }
            });

            lbThumbs.appendChild(t);
          });
        }

        let currentIndex = 0;

        function showLoader(show) {
          loader.style.display = show ? "block" : "none";
        }

        // Preload helper - also used to preload next/prev
        function preloadResource(item) {
          if (!item || !item.src) return;
          if (item.type === "image") {
            const link = document.createElement("link");
            link.rel = "preload";
            link.as = "image";
            link.href = item.src;
            link.dataset.tmp = "true";
            document.head.appendChild(link);
          } else if (item.type === "video") {
            const link = document.createElement("link");
            link.rel = "preload";
            link.as = "video";
            link.href = item.src;
            link.dataset.tmp = "true";
            document.head.appendChild(link);
          }
        }

        function clearPreloads() {
          document
            .querySelectorAll("link[data-tmp]")
            .forEach((n) => n.remove());
        }

        // render main preview depending on index
        function renderMain(item) {
          lbMainArea.innerHTML = ""; // clear
          if (!item) return;
          if (item.type === "image") {
            const img = new Image();
            img.alt = item.alt || "";
            img.onload = function () {
              showLoader(false);
              lbMainArea.innerHTML = "";
              img.className = "lb-main-media";
              lbMainArea.appendChild(img);
              // focus for a11y
              img.tabIndex = -1;
              try {
                img.focus();
              } catch (e) {}
            };
            img.onerror = function () {
              showLoader(false);
              lbMainArea.innerHTML =
                '<div style="color:#fff">Unable to load image</div>';
            };
            showLoader(true);
            img.src = item.src;
          } else {
            const video = document.createElement("video");
            video.controls = true;
            video.autoplay = true;
            video.playsInline = true;
            video.style.maxHeight = "78vh";
            video.setAttribute("aria-label", "Video preview");
            const source = document.createElement("source");
            source.src = item.src;
            source.type = "video/mp4";
            video.appendChild(source);
            video.onloadeddata = function () {
              showLoader(false);
              lbMainArea.innerHTML = "";
              lbMainArea.appendChild(video);
              try {
                video.focus();
              } catch (e) {}
            };
            video.onerror = function () {
              showLoader(false);
              lbMainArea.innerHTML =
                '<div style="color:#fff">Unable to load video</div>';
            };
            showLoader(true);
            video.load();
          }
        }

        // highlight active thumbnail and ensure it's visible (center-ish)
        function highlightThumb(index) {
          const all = lbThumbs.querySelectorAll(".lb-thumb");
          all.forEach((n) => n.classList.remove("active"));
          const active = lbThumbs.querySelector(
            '.lb-thumb[data-index="' + index + '"]'
          );
          if (active) {
            active.classList.add("active");
            // scroll active thumbnail into center-ish view
            const containerRect = lbThumbs.getBoundingClientRect();
            const btnRect = active.getBoundingClientRect();
            const offset =
              btnRect.left -
              containerRect.left -
              containerRect.width / 2 +
              btnRect.width / 2;
            lbThumbs.scrollBy({ left: offset, behavior: "smooth" });
            try {
              active.focus();
            } catch (e) {}
          }
        }

        function showLightbox(index, calledByThumb = false) {
          if (!gallery.length) return;
          currentIndex = (index + gallery.length) % gallery.length;
          overlayLB.style.display = "flex";
          overlayLB.setAttribute("aria-hidden", "false");

          // set focus trap start
          closeBtn.focus();

          // preload neighbors
          clearPreloads();
          preloadResource(gallery[(currentIndex + 1) % gallery.length]);
          preloadResource(
            gallery[(currentIndex - 1 + gallery.length) % gallery.length]
          );

          renderMain(gallery[currentIndex]);
          highlightThumb(currentIndex);
        }

        // attach click/keydown listeners to wrappers to open respective index
        wrappers.forEach((wrap, i) => {
          wrap.addEventListener("click", () => {
            showLightbox(i);
          });
          wrap.addEventListener("keydown", (e) => {
            if (e.key === "Enter" || e.key === " ") {
              e.preventDefault();
              showLightbox(i);
            }
          });
        });

        // Close
        function closeLightbox() {
          overlayLB.style.display = "none";
          overlayLB.setAttribute("aria-hidden", "true");
          lbMainArea.innerHTML = "";
          clearPreloads();
          // return focus to last focused element outside lightbox
          // We choose to focus first wrapper that corresponds to currentIndex (if present)
          const targetWrap = wrappers[currentIndex];
          if (targetWrap && typeof targetWrap.focus === "function") {
            try {
              targetWrap.focus();
            } catch (e) {}
          }
        }
        closeBtn.addEventListener("click", closeLightbox);
        overlayLB.addEventListener("click", (e) => {
          if (e.target === overlayLB) closeLightbox();
        });

        // Prev / Next
        function goto(delta) {
          showLightbox(currentIndex + delta);
        }
        nextBtn.addEventListener("click", () => goto(1));
        prevBtn.addEventListener("click", () => goto(-1));

        // keyboard navigation
        document.addEventListener("keydown", (e) => {
          if (overlayLB.style.display !== "flex") return;
          if (e.key === "Escape") closeLightbox();
          if (e.key === "ArrowRight") goto(1);
          if (e.key === "ArrowLeft") goto(-1);
        });

        // swipe support inside main area
        (function addSwipeSupport() {
          let startX = 0,
            startY = 0,
            isMoving = false,
            threshold = 30;
          lbMainArea.addEventListener(
            "touchstart",
            (e) => {
              if (!e.touches || e.touches.length > 1) return;
              startX = e.touches[0].clientX;
              startY = e.touches[0].clientY;
              isMoving = true;
            },
            { passive: true }
          );
          lbMainArea.addEventListener(
            "touchmove",
            (e) => {
              if (!isMoving || !e.touches || e.touches.length > 1) return;
              const dx = e.touches[0].clientX - startX;
              const dy = e.touches[0].clientY - startY;
              if (Math.abs(dx) > Math.abs(dy) && Math.abs(dx) > threshold) {
                if (dx < 0) goto(1);
                else goto(-1);
                isMoving = false;
              }
            },
            { passive: true }
          );
          lbMainArea.addEventListener("touchend", () => {
            isMoving = false;
          });
        })();

        // Focus trap inside lightbox: keep focus inside overlay when open
        (function focusTrap() {
          const focusableSelectors =
            'a[href], button, textarea, input, select, [tabindex]:not([tabindex="-1"])';
          let lastFocused = null;
          document.addEventListener("focusin", (e) => {
            if (overlayLB.style.display === "flex") {
              if (!overlayLB.contains(e.target)) {
                e.stopPropagation();
                closeBtn.focus();
              }
            } else {
              lastFocused = e.target;
            }
          });
          closeBtn.addEventListener("click", () => {
            if (lastFocused)
              try {
                lastFocused.focus();
              } catch (e) {}
          });
        })();

        // build thumbs on ready
        buildThumbs();

        // mark first thumb active by default (if needed)
        if (gallery.length) highlightThumb(0);
      })();
    </script>
  </body>
</html>
